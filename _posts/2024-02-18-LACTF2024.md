# LACTF2024

## Table of Contents
- [misc/infinite loop](#miscinfinite-loop)
- [misc/mixed signals](#miscmixed-signals)
- [misc/closed](#miscclosed)
- [rev/shattered memories](#revshattered-memories)
- [rev/aplet321](#revaplet321)
- [rev/the secret of java island](#revthe-secret-of-java-island)
- [pwn/aplet123](#pwnaplet123)
- [pwn/52 card monty](#pwn52-card-monty)
- [pwn/sus](#pwnsus)
- [pwn/pizza](#pwnpizza)

## Misc/Infinite Loop

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/70683b49-1cb9-40e3-8859-f4626eb68b29)

A google form challenge where it constantly loops and brings you back to the same page. Click on inspect source and search for the string "lactf" will reveal the flag.

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/8cb5b24d-ea52-4432-b0d5-2ee13e8a5947)

## Misc/Mixed Signals

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/18970d3f-026d-447d-bb12-22e1a0a9b1b8)

The authors accidentally uploaded the wrong file so we could hear the flag directly just by playing the video. Just replace the phonetic alphabets (eg: Alpha = A, Bravo = B, Charie = C)

## Misc/Closed

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/4717d495-bce0-44d2-815c-be23542e1e48)

### Image given : 

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/a12b5b1d-8787-479a-8344-620d1e4560a7)

From the image above, we can deduce that this location is in California and its located next to a big body of water.

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/3f0b9777-ef5c-4f96-83d8-d062ba10f72c)

On closer inspection, we can see words which I can only assume is "Shore Trail". So I used the app AllTrails and searched for the term "Shore Trail California". The results show that there is a East Shore Trail, West Shore Trail and South Shore Trail. So I immediately went to Google Maps and manually looked at each trail.

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/c449baf6-4d3e-4db4-99cf-965cbba6a039)

The South Shore Trail looked the most promising.

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/97a57776-2ec0-4932-b19a-fc1b2150f27e)

We found the exact rock in the picture. Clicking on the bottom left corner of the rock gave us the coordinates

> Flag : lactf{36.516,-121.949}

## Rev/Shattered Memories

```
└─$ strings shattered-memories      
What was the flag again?
No, I definitely remember it being a different length...
t_what_f
t_means}
nd_forge
lactf{no
orgive_a
No, that definitely isn't it.
```

Just run strings on it and reassemble the flag.

## Rev/Aplet321

### Decompiled Code
```c
    do {
      iVar1 = strncmp(pcVar3,"pretty",6);
      NumOfPretty = NumOfPretty + (uint)(iVar1 == 0);
      iVar1 = strncmp(pcVar3,"please",6);
      NumOfPlease = NumOfPlease + (uint)(iVar1 == 0);
      pcVar3 = pcVar3 + 1;
    } while (pcVar3 != acStack_237 + ((int)sVar2 - 6));
    if (NumOfPlease != 0) {
      pcVar3 = strstr(&local_238,"flag");
      if (pcVar3 == (char *)0x0) {
        puts("sorry, i didn\'t understand what you mean");
        return 0;
      }
      if ((NumOfPretty + NumOfPlease == 0x36) && (NumOfPretty - NumOfPlease == -0x18)) {
        puts("ok here\'s your flag");
        system("cat flag.txt");
        return 0;
      }
```

The program will print out the flag if we say "pretty" 15 times, "please" 39 times and "flag".

```
prettyprettyprettyprettyprettyprettyprettyprettyprettyprettyprettyprettyprettyprettyprettypleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleasepleaseflag
```

## Rev/The Secret of Java Island

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/415ce8fa-abdd-48af-877b-39c27ce5a431)

Looks like its a choice-driven game when running the program. Decompile the jar file using a [online decompiler](https://www.decompiler.com/).

From the decompiled code, the game moves from state to state depending on the choices we make.

```java
 case 5:
         try {
            Socket var0 = new Socket("chall.lac.tf", 31151);
            String var1 = "";

            int var3;
            for(Iterator var2 = history.iterator(); var2.hasNext(); var1 = var1 + var3) {
               var3 = (Integer)var2.next();
            }

            var0.getOutputStream().write((var1 + "\n").getBytes("UTF-8"));
            Scanner var5 = new Scanner(var0.getInputStream());
            String var6 = var5.nextLine();
            story.setText(var6);
            var5.close();
            var0.close();
         } catch (Exception var4) {
            System.err.println(var4.getMessage());
            story.setText("<html>The flag is garbled and unreadable. Contact an admin if you haven't done anything out of the ordinary.</html>");
         }

         button1.setText("Leave");
         button2.setText("Leave");
         break;
```

State 5 prints out the flag so this should be our end goal.

```
      case 3:
         if (!hasGlove) {
            System.exit(0);
         } else {
            state = 5;
         }
```

For us to reach state 5, we will need to be in state 3 and hasGlove must be true. I wrote down all the conditions on a piece of paper to visualize it

![image](https://github.com/fyrepaw13/fyrepaw13.github.io/assets/62428064/805c1736-a729-42f3-9368-811f4734ffeb)



## Pwn/Aplet123

## Pwn/52 Card Monty

## Pwn/Sus

## Pwn/Pizza
